@page
@model Apartment.Pages.Tenant.PaymentHistoryModel
@using System.Globalization
@{
    ViewData["Title"] = "Payment History";
    Layout = "_Layout";
    var pesoCulture = CultureInfo.CreateSpecificCulture("en-PH");
}

<div class="d-flex">
    @await Html.PartialAsync("_TenantSidebar")

    <div class="main-content">
        <h1 class="page-title">Payment History</h1>
        <p class="page-subtitle">All successful payments made to your account.</p>

        @if (Model.Payments.Any())
        {
            <div class="matcha-card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="matcha-table data-table" id="paymentHistoryTable">
                            <thead>
                                <tr>
                                    <th class="text-center">Transaction ID</th>
                                    <th class="text-center">Date Fully Settled</th>
                                    <th class="text-center">Amount Paid</th>
                                    <th class="text-center">Payment Method</th>
                                    <th class="text-center">Invoice Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var payment in Model.Payments)
                                {
                                    <tr>
                                        <td class="numeric-font text-center">#@payment.TransactionId</td>
                                        <td class="text-center">@payment.DateFullySettled.ToString("MMMM dd, yyyy")</td>
                                        <td class="amount-paid numeric-font text-center">@payment.AmountPaid.ToString("C", pesoCulture)</td>
                                        <td class="text-center">@payment.PaymentMethod</td>
                                        <td class="text-center">@payment.InvoiceReference</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="matcha-card empty-state-card">
                 <div class="empty-state-icon-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-credit-card" viewBox="0 0 16 16">
                      <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-.5.5v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z"/>
                      <path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z"/>
                    </svg>
                </div>
                <h3 class="empty-state-title">No Payment History</h3>
                <p class="empty-state-message">
                    You haven't made any payments yet. Records will appear here once you complete a transaction.
                </p>
            </div>
        }
    </div>
</div>

<style>
    /* 1. BRAND FOUNDATION & COLOR SYSTEM */
    :root {
        /* Primary Palette */
        --matcha-deep-green: #4A6F47;
        --matcha-soft-green: #A8C3A0;
        --ceremonial-matcha: #7DA26C;
        --fresh-cream-white: #F9F8F3;

        /* Secondary Palette */
        --roasted-brown: #8B6F47;
        --golden-whisk: #D7A85A;
        --azuki-red: #B35A5A;

        /* Neutral Palette */
        --ink-black: #2C2C2C;
        --leaf-gray: #7B7B7B;
        --tea-mist: #E7E5D8;
        
        /* Typography */
        --font-headings: 'Cormorant Garamond', Georgia, serif;
        --font-body: 'Inter', Arial, sans-serif;
        --font-numeric: 'JetBrains Mono', Consolas, monospace;
    }

    /* 2. TYPOGRAPHY & LAYOUT */
    .main-content {
        background-color: var(--fresh-cream-white);
        min-height: 100vh;
        width: calc(100% - 280px); 
        margin-left: 280px; 
        padding: 32px;
        font-family: var(--font-body);
        color: var(--ink-black);
    }
    
    .page-title {
        font-family: var(--font-headings);
        font-weight: 700;
        font-size: 36px;
        color: var(--matcha-deep-green);
        margin-bottom: 8px;
    }

    .page-subtitle {
        font-size: 18px;
        color: var(--leaf-gray);
        margin-bottom: 32px;
    }

    .numeric-font {
        font-family: var(--font-numeric);
    }

    /* 3. UI COMPONENTS */

    /* Cards */
    .matcha-card {
        background-color: var(--fresh-cream-white);
        border: 1px solid var(--tea-mist);
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        padding: 28px;
        border-top: 4px solid var(--golden-whisk);
    }
    
    .card-body {
        padding: 0; /* Reset bootstrap padding */
    }

    /* Tables (Billing-Centric) */
    .table-responsive {
        width: 100%;
        overflow-x: auto;
    }

    .matcha-table {
        width: 100%;
        border-collapse: collapse;
        table-layout: auto;
        min-width: 100%;
    }

    .matcha-table th, 
    .matcha-table td {
        padding: 14px 16px;
        border-bottom: 1px solid var(--tea-mist);
        font-size: 15px;
        vertical-align: middle;
        text-align: center !important;
    }

    .matcha-table thead tr {
        background-color: var(--matcha-deep-green);
        color: var(--fresh-cream-white);
    }
    
    .matcha-table thead th {
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: none;
        white-space: nowrap;
        padding: 16px;
        text-align: center !important;
    }

    .matcha-table tbody td {
        text-align: center !important;
    }

    /* Column width distribution */
    .matcha-table th:nth-child(1),
    .matcha-table td:nth-child(1) {
        width: 10%;
        min-width: 110px;
        text-align: center !important;
    }

    .matcha-table th:nth-child(2),
    .matcha-table td:nth-child(2) {
        width: 18%;
        min-width: 170px;
        text-align: center !important;
    }

    .matcha-table th:nth-child(3),
    .matcha-table td:nth-child(3) {
        width: 14%;
        min-width: 130px;
        text-align: center !important;
    }

    .matcha-table th:nth-child(4),
    .matcha-table td:nth-child(4) {
        width: 16%;
        min-width: 140px;
        text-align: center !important;
    }

    .matcha-table th:nth-child(5),
    .matcha-table td:nth-child(5) {
        width: 42%;
        min-width: 220px;
        text-align: center !important;
    }

    /* Text alignment classes */
    .text-start {
        text-align: left !important;
    }

    .text-end {
        text-align: right !important;
    }

    .text-center {
        text-align: center !important;
    }

    .matcha-table tbody tr:nth-child(even) {
        background-color: #F0F3EF; /* A lighter version of soft green for subtlety */
    }

    .matcha-table tbody tr:hover {
        background-color: var(--ceremonial-matcha);
        color: white;
        transition: background-color 150ms ease-out;
    }
    
    .matcha-table .amount-paid {
        font-weight: 600;
        color: var(--matcha-deep-green);
        text-align: center !important;
    }
    
    .matcha-table td {
        color: var(--ink-black);
        text-align: center !important;
    }

    .matcha-table td.numeric-font {
        text-align: center !important;
    }
    
    .matcha-table tr:hover td, 
    .matcha-table tr:hover .amount-paid, 
    .matcha-table tr:hover .numeric-font {
        color: var(--fresh-cream-white);
    }

    /* Ensure DataTables headers maintain alignment */
    table.dataTable thead th,
    table.dataTable thead td {
        background-color: var(--matcha-deep-green) !important;
        color: var(--fresh-cream-white) !important;
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: none;
        padding: 16px !important;
        text-align: center !important;
    }

    table.dataTable tbody td {
        text-align: center !important;
        padding: 14px 16px !important;
        vertical-align: middle !important;
    }

    table.dataTable tbody td.numeric-font,
    table.dataTable tbody td.amount-paid {
        text-align: center !important;
    }

    table.dataTable thead th.text-center,
    table.dataTable thead td.text-center {
        text-align: center !important;
    }

    /* Force center alignment for all table cells */
    #paymentHistoryTable th,
    #paymentHistoryTable td {
        text-align: center !important;
    }

    #paymentHistoryTable.dataTable th,
    #paymentHistoryTable.dataTable td {
        text-align: center !important;
    }

    /* DataTables wrapper spacing */
    #paymentHistoryTable_wrapper {
        width: 100%;
    }

    #paymentHistoryTable_wrapper .dataTables_length,
    #paymentHistoryTable_wrapper .dataTables_filter {
        margin-bottom: 16px;
    }

    #paymentHistoryTable_wrapper .dataTables_info,
    #paymentHistoryTable_wrapper .dataTables_paginate {
        margin-top: 16px;
    }


    /* Empty State */
    .empty-state-card {
        text-align: center;
        padding: 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-top: 4px solid var(--tea-mist); /* Use a neutral color for empty state */
    }
    
    .empty-state-icon-wrapper {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background-color: #eef2ed;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 24px;
        color: var(--matcha-deep-green);
    }
    
    .empty-state-title {
        font-family: var(--font-headings);
        font-size: 24px;
        color: var(--ink-black);
        font-weight: 600;
        margin-bottom: 8px;
    }

    .empty-state-message {
        font-size: 16px;
        color: var(--leaf-gray);
        max-width: 400px;
        line-height: 1.6;
    }
</style>